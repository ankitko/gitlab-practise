Some logical changes
Some More changes from Ankit branch
